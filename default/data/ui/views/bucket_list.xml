<form class="formsearch">
  <label>Bucket Finder</label>

  <searchTemplate>
earliest=@d
`_fb_summary_recs($host$, $index$)`
| fields _time, startEpoch, earliestTime, endEpoch, latestTime, eventCount, sizeOnDiskMB, guId, index, state, id
| sort startEpoch, earliestTime, endEpoch, latestTime
  </searchTemplate>

  <row>
    <html>
<div id="fire_brigade_help">
</div>
    </html>
  </row>

  <fieldset>
    <input type="dropdown" token="host" searchWhenChanged="true">
      <label>Host</label>
      <populatingSearch fieldForValue="orig_host" fieldForLabel="orig_host">| inputlookup fb_hostname_index_cache | dedup orig_host | sort orig_host</populatingSearch>
    </input>
    <input type="dropdown" token="index" searchWhenChanged="true">
      <label>Index</label>
      <choice value="*">All indexes</choice>
      <populatingSearch fieldForValue="orig_index" fieldForLabel="orig_index">| inputlookup fb_hostname_index_cache | search orig_host=$host$ | dedup orig_index | sort orig_index</populatingSearch>
    </input>
  </fieldset>

  <row>
    <table>
      <title>Bucketses</title>
      <option name="link.visible">false</option>
      <option name="count">50</option>
      <option name="drilldown">row</option>
      <drilldown>
        <link><![CDATA[
/app/fire_brigade/bucket_search?form.et=$row.et$&form.lt=$row.lt$&form.index=$row.index$&form.bucket_id=$row.bid$]]>
	</link>
      </drilldown>
      <searchString>
earliest=@d
`_fb_summary_recs($host$, $index$)`
| fields _time, startEpoch, earliestTime, endEpoch, latestTime, eventCount, sizeOnDiskMB, guId, index, state, id
| eval et=coalesce(startEpoch,
    round(strptime(earliestTime, "%m/%d/%Y:%H:%M:%S"), 0))
| eval lt=coalesce(endEpoch,
    round(strptime(latestTime, "%m/%d/%Y:%H:%M:%S"), 0))
| sort startEpoch, earliestTime, endEpoch, latestTime
| eval bid=index . "~" . id . "~" . guId
| table _time, et, lt, index, eventCount, sizeOnDiskMB, state, id, bid
      </searchString>
    </table>
  </row>
</form>
